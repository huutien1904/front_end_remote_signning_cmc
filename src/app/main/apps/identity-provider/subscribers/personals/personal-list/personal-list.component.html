<div class="header-personal">
  <!-- search filter -->
  <div class="card">
    <!-- search -->
    <h5 class="card-header">Bộ lọc tìm kiếm</h5>
    <div class="card-body">
      <form class="form form-vertical" [formGroup]="formListPersonal">
        <div class="row mb-1">
          <div class="col-md-6">
            <input
              name="distinguishedName"
              id="distinguishedName"
              type="search"
              class="form-control"
              formControlName="inputPersonal"
              placeholder="Nhập họ tên email địa chỉ"
            />
          </div>
        </div>
        <div class="row mb-1">
          <div class="col-md-2">
            <label class="lable">Giới tính</label>
            <fieldset class="form-group">
              <ng-select
                [items]="gender"
                [clearable]="true"
                bindLabel="name"
                bindValue="name"
                placeholder="Giới tính"
              >
              </ng-select>
            </fieldset>
          </div>
          <div class="col-md-2">
            <label class="lable">Ngày sinh</label>
            <div class="input-group input-group-merge">
              <div class="input-group-prepend">
                <span class="input-group-text" (click)="birthday.open()"
                  ><i data-feather="calendar"></i
                ></span>
              </div>
              <input
                [matDatepicker]="birthday"
                formControlName="birthday"
                class="form-control"
                type="text"
                placeholder="19/04/1992"
              />
            </div>
            <mat-datepicker #birthday></mat-datepicker>
          </div>
        </div>
        <div class="row mb-1">
          <div class="col-12 mb-1">
            <button
              class="btn btn-outline-secondary mr-1"
              rippleEffect
              (click)="moreOption = !moreOption"
            >
              <!-- <span [data-feather]="'clock'" [class]="'mr-50'"></span> -->
              <i
                data-feather="plus"
                class="d-sm-none d-inline-block mr-0 mr-sm-1"
              ></i
              ><span class="d-none d-sm-inline-block">Thêm tùy chọn</span>
            </button>
            <button
              type="button"
              rippleEffect
              class="btn btn-primary"
              (click)="onSubmit()"
              [disabled]="!formListPersonal.valid"
            >
              Tìm kiếm
            </button>
          </div>
        </div>
        <div class="row" [ngbCollapse]="moreOption">
          <div class="col-md-2">
            <label for="">Số dòng:</label>
            <fieldset class="form-group">
              <ng-select
                [items]="sizePage"
                bindValue="sizePage"
                [clearable]="false"
                formControlName="sizePage"
                (change)="selectItem()"
              ></ng-select>
            </fieldset>
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-3">
                <label class="lable">Từ ngày:</label>
                <div class="input-group input-group-merge">
                  <div class="input-group-prepend">
                    <span class="input-group-text" (click)="fromDate.open()"
                      ><i data-feather="calendar"></i
                    ></span>
                  </div>
                  <input
                    [matDatepicker]="fromDate"
                    formControlName="fromDate"
                    class="form-control"
                    type="text"
                    [min]="minDate"
                    [max]="formListPersonal.controls.toDate.value"
                    placeholder="13/09/2021"
                  />
                </div>
                <mat-datepicker #fromDate></mat-datepicker>
              </div>
              <div class="col-md-3">
                <label class="lable">Đến ngày:</label>
                <div class="input-group input-group-merge">
                  <div class="input-group-prepend">
                    <span class="input-group-text" (click)="toDate.open()"
                      ><i data-feather="calendar"></i
                    ></span>
                  </div>
                  <input
                    [matDatepicker]="toDate"
                    formControlName="toDate"
                    class="form-control"
                    type="text"
                    [min]="formListPersonal.controls.fromDate.value"
                    placeholder="13/09/2021"
                  />
                </div>
                
                <mat-datepicker #toDate ></mat-datepicker>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- end search filter -->

  <div class="table_content-wrap">
    <div
      class="
        col-md-12 col-12
        d-flex
        justify-content-start justify-content-md-end
      "
    >
      <button
        class="btn btn-primary ml-1 mb-1"
        rippleEffect
        (click)="openNewPersonalModal(newPersonal)"
      >
        <span [data-feather]="'clock'" [class]="'mr-50'"></span>
        <i data-feather="plus" class="d-sm-none d-inline-block mr-0 mr-sm-1"></i
        ><span class="d-none d-sm-inline-block">Thêm Mới</span>
      </button>
      <ng-template #newPersonal let-modal>
        <div class="modal-header">
          <h2 class="modal-title" id="myModalLabel160">
            Đăng ký thuê bao cá nhân
          </h2>

          <button
            type="button"
            class="close btn-primary"
            (click)="modal.close()"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" tabindex="0" ngbAutofocus>
          <app-new-personal-sidebar
            (onUpdate)="updateTable()"
          ></app-new-personal-sidebar>
        </div>
      </ng-template>
    </div>
    <div class="card">
      <div class="row">
        <div class="col-12">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>TT</th>
                  <th>CCCD/Passport</th>
                  <th>HỌ VÀ TÊN</th>
                  <th>NGÀY SINH</th>
                  <th>GIỚI TÍNH</th>
                  <th>EMAIL</th>
                  <th>TỔ CHỨC</th>
                  <th>XEM THÊM</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of rows; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>{{ item.personalCountryId }}</td>
                  <td>
                    {{ item.personalFirstName }} {{ item.personalMiddleName }}
                    {{ item.personalLastName }}
                  </td>
                  <td>{{ item.birthday }}</td>
                  <td>{{ item.gender }}</td>
                  <td>
                    {{ item.email | limitTo: 20
                    }}{{ item.email.length > 20 ? "..." : "" }}
                  </td>
                  <td>{{ item.organizationId == null ? "Không có" : "" }}</td>
                  <td>
                    <div ngbDropdown container="body">
                      <button
                        ngbDropdownToggle
                        type="button"
                        class="btn icon-btn btn-sm hide-arrow"
                        rippleEffect
                      >
                        <span
                          [data-feather]="'more-vertical'"
                          [class]="'cursor-pointer'"
                        ></span>
                      </button>
                      <div ngbDropdownMenu>
                        <a
                          routerLink="/apps/ip/subscribers/personals/personal-view/{{
                            item.personalId
                          }}"
                          ngbDropdownItem
                          ><span
                            [data-feather]="'file-text'"
                            [size]="16"
                            [class]="'mr-50'"
                          ></span>
                          Details</a
                        ><a
                          routerLink="/apps/user/user-edit/{{
                            item.personalId
                          }}"
                          ngbDropdownItem
                          ><span
                            [data-feather]="'edit'"
                            [size]="16"
                            [class]="'mr-50'"
                          ></span>
                          Edit</a
                        ><a href="javascript:;" ngbDropdownItem
                          ><span
                            [data-feather]="'trash'"
                            [size]="16"
                            [class]="'mr-50'"
                          ></span>
                          Delete</a
                        >
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="row d-flex justify-content-between align-items-center">
        <div class="col-xl-2 ml-1">
          <div class="total_item">{{ formListPersonal.controls.sizePage.value }} dòng</div>
        </div>
        <div class="col-xl-6 mt-1 mr-1">
          <ngb-pagination
            [(collectionSize)]="totalPages"
            [(page)]="pageAdvancedEllipses"
            [maxSize]="3"
            [rotate]="true"
            [boundaryLinks]="true"
            (pageChange)="changePage($event)"
            class="d-flex justify-content-end"
          >
            <ng-template ngbPaginationFirst>Đầu</ng-template>
            <ng-template ngbPaginationLast>Cuối</ng-template>
          </ngb-pagination>
        </div>
      </div>
      
    </div>
  </div>
</div>
